# 多餐廳設定指南

## 📋 新的「設定」工作表結構

### 標題行（第 1 行）

| A1 | B1 | C1 |
|----|----|-----|
| 餐廳名稱 | 菜單圖片網址 | 啟用 |

### 資料行（第 2 行開始）

| A | B | C |
|---|---|---|
| 美味麵館 | https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800 | TRUE |
| 便當王 | https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=800 | FALSE |
| 素食天地 | https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=800 | FALSE |

## 🎯 使用方式

### 切換今日餐廳

1. 打開 Google Sheet 的「設定」工作表
2. 找到你想要啟用的餐廳那一列
3. 將該列的「啟用」欄位（C 欄）改為 `TRUE`
4. 將其他餐廳的「啟用」欄位改為 `FALSE`
5. 重新載入前端應用程式

### 範例：切換到「便當王」

**修改前：**
| 餐廳名稱 | 菜單圖片網址 | 啟用 |
|---------|-------------|------|
| 美味麵館 | https://... | TRUE |
| 便當王 | https://... | FALSE |

**修改後：**
| 餐廳名稱 | 菜單圖片網址 | 啟用 |
|---------|-------------|------|
| 美味麵館 | https://... | FALSE |
| 便當王 | https://... | TRUE |

## ✅ 優點

1. **集中管理**：所有餐廳資料都在同一個工作表
2. **快速切換**：只需改一個欄位就能切換餐廳
3. **易於擴充**：新增餐廳只需加一列
4. **不會遺失資料**：切換餐廳時，其他餐廳的設定都保留

## 📝 完整設定步驟

### 步驟 1：修改「設定」工作表

1. 打開你的 Google Sheet
2. 進入「設定」工作表
3. 修改標題行（第 1 行）：
   - A1: `餐廳名稱`
   - B1: `菜單圖片網址`
   - C1: `啟用`

4. 填入所有餐廳資料（從第 2 行開始）：

```
美味麵館	https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800	TRUE
便當王	https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=800	FALSE
素食天地	https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=800	FALSE
```

### 步驟 2：更新 Google Apps Script

1. 在 Google Sheet 中，點擊「擴充功能」→「Apps Script」
2. 將 `Code.gs` 的內容替換為更新後的程式碼
3. 儲存（Ctrl+S 或 Cmd+S）
4. 重新部署（如果需要）

### 步驟 3：測試

1. 在 Apps Script 編輯器中，選擇 `testDoGetJSON` 函數
2. 點擊「執行」
3. 查看執行記錄，確認讀取到正確的餐廳

## 🔍 API 行為說明

### 讀取邏輯

```javascript
// Google Apps Script 會：
1. 讀取「設定」工作表的所有資料
2. 從第 2 行開始逐行檢查
3. 找到第一個「啟用 = TRUE」的餐廳
4. 使用該餐廳的名稱和菜單圖片網址
5. 根據餐廳名稱篩選「餐點」和「加購」工作表的資料
```

### 啟用欄位的有效值

以下值都會被視為「啟用」：
- `TRUE` (布林值)
- `true` (字串)
- `1` (數字)

以下值會被視為「未啟用」：
- `FALSE` (布林值)
- `false` (字串)
- `0` (數字)
- 空白

## ⚠️ 注意事項

1. **只能啟用一家餐廳**：系統會使用第一個找到的啟用餐廳
2. **至少要有一家啟用**：如果所有餐廳都是 FALSE，API 會回傳錯誤
3. **餐廳名稱要一致**：「設定」工作表的餐廳名稱必須與「餐點」和「加購」工作表完全一致
4. **菜單圖片網址必填**：啟用的餐廳必須有菜單圖片網址

## 🐛 故障排除

### 問題：API 回傳「請在設定工作表中將至少一家餐廳的「啟用」欄位設為 TRUE」

**解決方法：**
- 檢查「啟用」欄位是否為 `TRUE`（大寫）
- 確認沒有多餘的空格
- 可以直接在儲存格中輸入 `=TRUE()` 公式

### 問題：切換餐廳後，前端還是顯示舊的餐廳

**解決方法：**
- 重新載入前端應用程式（按 F5 或 Ctrl+R）
- 清除瀏覽器快取

### 問題：新增的餐廳沒有餐點顯示

**解決方法：**
- 檢查「餐點」工作表中，該餐廳的餐點資料是否正確
- 確認「餐廳名稱」欄位與「設定」工作表完全一致（包含空格、大小寫）

## 📊 範例資料

### 設定工作表

```
餐廳名稱	菜單圖片網址	啟用
美味麵館	https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800	TRUE
便當王	https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=800	FALSE
素食天地	https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=800	FALSE
```

### 餐點工作表（保持不變）

```
餐廳名稱	餐點ID	餐點名稱	餐點價格	備註選項	加購項目ID
美味麵館	meal_001	紅燒牛肉麵	80	加辣,粗麵,細麵	addon_001,addon_002
美味麵館	meal_002	炸醬麵	70	加辣,粗麵,細麵	addon_001,addon_002
便當王	meal_004	炸雞便當	75	去骨,加辣	addon_003,addon_004
便當王	meal_005	排骨便當	80	加辣	addon_003,addon_004
素食天地	meal_007	素食便當	70	不加蔥,不加蒜	addon_005
```

### 加購工作表（保持不變）

```
餐廳名稱	加購ID	加購名稱	加購價格
美味麵館	addon_001	加麵	10
美味麵館	addon_002	焗烤	20
便當王	addon_003	飲料	15
便當王	addon_004	加飯	5
素食天地	addon_005	豆漿	10
```

## 🎉 完成！

現在你可以輕鬆管理多家餐廳，只需要改一個欄位就能切換今日餐廳！
